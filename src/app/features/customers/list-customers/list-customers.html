<div class="list-card">

  <!-- Header -->
  <div class="list-header">
    <div class="list-header-left">
      <div class="header-icon"><i class="fa fa-users"></i></div>
      <div>
        <h5 class="header-title">Liste des Clients</h5>
        <p class="header-subtitle">
          <span class="total-badge">{{ totalElements }}</span> client(s) enregistré(s)
        </p>
      </div>
    </div>

    <div class="list-header-right">
      <!-- Search -->
      <div class="search-box">
        <i class="fa fa-search search-icon"></i>
        <input type="text" class="search-input"
               placeholder="Rechercher par nom, email ou ID..."
               [value]="searchQuery"
               (input)="onSearch.emit($any($event.target).value)"/>
        @if (isLoading) {
          <span class="search-status">
            <i class="fa fa-spinner fa-spin"></i>
          </span>
        }
        @if (searchQuery && !isLoading) {
          <button class="search-clear" (click)="onClearSearch.emit()">
            <i class="fa fa-times"></i>
          </button>
        }
      </div>

      <!-- Page size -->
      <select class="page-size-select"
              [value]="pageSize"
              (change)="onPageSizeChange.emit(+$any($event.target).value)">
        <option value="5">5 / page</option>
        <option value="10">10 / page</option>
        <option value="25">25 / page</option>
        <option value="50">50 / page</option>
      </select>
    </div>
  </div>

  <!-- Table -->
  <div class="table-wrapper">
    <table class="customers-table">
      <thead>
      <tr>
        <th>ID</th>
        <th>Nom</th>
        <th>Email</th>
        <th class="text-center">Actions</th>
      </tr>
      </thead>
      <tbody>
        @if (isLoading) {
          @for (i of [1,2,3,4,5]; track i) {
            <tr class="skeleton-row">
              <td><div class="skeleton short"></div></td>
              <td><div class="skeleton medium"></div></td>
              <td><div class="skeleton long"></div></td>
              <td><div class="skeleton short"></div></td>
            </tr>
          }
        } @else {
          @for (customer of customers; track customer.id; let i = $index) {
            <tr class="data-row" [style.animation-delay]="i * 40 + 'ms'">
              <td>
                <span class="id-badge">#{{ customer.id }}</span>
              </td>
              <td>
                <div class="customer-name">
                  <!-- <div class="customer-avatar">{{ customer.name?.charAt(0).toUpperCase() }}</div> -->
                  <span>{{ customer.name }}</span>
                </div>
              </td>
              <td>
                <div class="email-cell">
                  <!-- <i class="fa fa-envelope"></i> -->
                  {{ customer.email }}
                </div>
              </td>
              <td>
                <div class="actions-cell">
                  <button class="action-btn edit" title="Modifier">
                    <i class="fa fa-pen"></i>
                  </button>
                  <button class="action-btn delete" title="Supprimer">
                    <i class="fa fa-trash"></i>
                  </button>
                  <button class="action-btn view" title="Détail">
                    <i class="fa fa-eye"></i>
                  </button>
                </div>
              </td>
            </tr>
          } @empty {
            <tr>
              <td colspan="4">
                <div class="empty-state">
                  @if (searchQuery) {
                    <i class="fa fa-search empty-icon"></i>
                    <p>Aucun résultat pour <strong>"{{ searchQuery }}"</strong></p>
                    <button class="btn-clear" (click)="onClearSearch.emit()">
                      <i class="fa fa-times"></i> Effacer la recherche
                    </button>
                  } @else {
                    <i class="fa fa-inbox empty-icon"></i>
                    <p>Aucun client enregistré</p>
                  }
                </div>
              </td>
            </tr>
          }
        }
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  @if (totalPages > 1) {
    <div class="list-footer">
      <span class="pagination-info">
        Page <strong>{{ currentPage + 1 }}</strong> sur <strong>{{ totalPages }}</strong>
        — {{ totalElements }} résultat(s)
      </span>
      <div class="pagination">
        <button class="page-btn nav" [disabled]="currentPage === 0" (click)="onPageChange.emit(0)">
          <i class="fa fa-angles-left"></i>
        </button>
        <button class="page-btn nav" [disabled]="currentPage === 0" (click)="onPageChange.emit(currentPage - 1)">
          <i class="fa fa-chevron-left"></i>
        </button>
        @for (page of pages; track page) {
          <button class="page-btn" [class.active]="page === currentPage" (click)="onPageChange.emit(page)">
            {{ page + 1 }}
          </button>
        }
        <button class="page-btn nav" [disabled]="currentPage === totalPages - 1" (click)="onPageChange.emit(currentPage + 1)">
          <i class="fa fa-chevron-right"></i>
        </button>
        <button class="page-btn nav" [disabled]="currentPage === totalPages - 1" (click)="onPageChange.emit(totalPages - 1)">
          <i class="fa fa-angles-right"></i>
        </button>
      </div>
    </div>
  }

</div>
